%html
  %head
    %title
      Play This

    = csrf_meta_tags
    = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
    = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
    = action_cable_meta_tag

    %meta{:content => "width=device-width, initial-scale=1", :name => "viewport"}

  %body{ class: "#{yield (:body_class)}" }
    %nav.navbar.navbar-fixed-top.bg-custom
      .navbar-header
        %button.navbar-toggler.pull-xs-right.hidden-lg-up{type: 'button', 'data-toggle': 'collapse', 'data-target': '#navContent'}
          &#9776;

        = link_to root_path, class: "navbar-brand hidden-xs-down" do
          %i.fa.fa-music
          Play This

      .collapse.navbar-toggleable-md{id: 'navContent'}
        = link_to root_path, class: "navbar-brand hidden-sm-up" do
          %i.fa.fa-music
          Play This

        %ul.nav.navbar-nav.pull-xs-right
          %li.nav-item
            = link_to join_events_path, class: "nav-link" do
              %i.fa.fa-share
              Join an Event

          - if user_signed_in?
            %li.nav-item
              = link_to new_event_path, class: "nav-link" do
                %i.fa.fa-users
                Host an Event
            %li.nav-item
              = link_to user_path(current_user), class: "nav-link" do
                %i.fa.fa-user
                Your Profile
            %li.nav-item.dropdown
              %button.btn.btn-primary.dropdown-toggle{ type: "button", "data-toggle": "dropdown" }
                = current_user.email
                %span.caret
              %ul.dropdown-menu
                %li
                  = link_to destroy_user_session_path, :method => :delete, class: "dropdown-item" do
                    %i.fa.fa-sign-out
                    Sign Out
          - else
            %li.nav-item
              = link_to new_user_session_path, class: "nav-link" do
                %i.fa.fa-sign-in
                Sign In
            %li.nav-item
              = link_to new_user_registration_path, class: "nav-link" do
                %i.fa.fa-user-plus
                Sign Up


    .container.container-custom
      - unless flash.empty?
        - flash.each do |name, msg|
          - if msg.is_a?(String)
            %div{ class: "alert alert-#{name == :notice.to_s ? "success" : "danger"} flash-display" }
              %a.close{ "data-dismiss": "alert" }
                %i.fa.fa-times
              = content_tag :div, msg, :id => "flash_#{name}"

    = yield
